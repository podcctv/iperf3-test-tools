<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Redis ç›‘æ§ - iperf3 Master</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.15.1/cdn/themes/dark.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@radix-ui/themes@3.1.1/dist/css/themes.css" />
    <script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.15.1/cdn/shoelace.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="/static/glass-design.css" />
    <!-- Common Styles -->
    <link rel="stylesheet" href="/static/theme.css" />
    <link rel="stylesheet" href="/static/sidebar.css" />
    <style>
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .animate-spin {
            animation: spin 1s linear infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        /* Progress bar animation */
        .progress-bar {
            transition: width 0.3s ease-in-out;
        }

        /* Stat card hover effect */
        .stat-card {
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
        }
    </style>
    <script src="/static/theme.js" defer></script>
</head>

<body class="min-h-screen text-white">
    <div class="radix-themes min-h-screen" data-theme="dark">
        <div class="app-layout">
            <!-- Sidebar Navigation -->
            <aside class="sidebar hidden" id="sidebar">
                <div class="sidebar-brand">
                    <div class="sidebar-logo">ğŸ“Š</div>
                    <div>
                        <div class="sidebar-title">iPerf3</div>
                        <div class="sidebar-subtitle">ç½‘ç»œæµ‹è¯•</div>
                    </div>
                </div>

                <nav class="sidebar-nav">
                    <div class="nav-section">
                        <div class="nav-section-title">ç›‘æ§é¢æ¿</div>
                        <a href="/web" class="nav-item" data-page="dashboard">
                            <span class="nav-item-icon">ğŸ </span>
                            <span>èŠ‚ç‚¹æ¦‚è§ˆ</span>
                        </a>
                        <a href="/web/tests" class="nav-item" data-page="tests">
                            <span class="nav-item-icon">ğŸš€</span>
                            <span>é€Ÿåº¦æµ‹è¯•</span>
                        </a>
                        <a href="/web/schedules" class="nav-item" data-page="schedules">
                            <span class="nav-item-icon">ğŸ“…</span>
                            <span>å®šæ—¶ä»»åŠ¡</span>
                        </a>
                    </div>

                    <div class="nav-section">
                        <div class="nav-section-title">è·¯ç”±åˆ†æ</div>
                        <a href="/web/trace" class="nav-item" data-page="trace">
                            <span class="nav-item-icon">ğŸ”</span>
                            <span>å•æ¬¡è¿½è¸ª</span>
                        </a>
                        <a href="/web/trace#schedules" class="nav-item" data-page="trace-schedules">
                            <span class="nav-item-icon">ğŸ“…</span>
                            <span>å®šæ—¶è¿½è¸ª</span>
                        </a>
                        <a href="/web/trace#compare" class="nav-item" data-page="compare">
                            <span class="nav-item-icon">ğŸ“Š</span>
                            <span>å¤šå…ƒå¯¹æ¯”</span>
                        </a>
                        <a href="/web/trace#history" class="nav-item" data-page="history">
                            <span class="nav-item-icon">ğŸ“œ</span>
                            <span>å†å²è®°å½•</span>
                        </a>
                    </div>

                    <div class="nav-section guest-hide">
                        <div class="nav-section-title">ç³»ç»Ÿè®¾ç½®</div>
                        <a href="/web/redis" class="nav-item active" data-page="redis">
                            <span class="nav-item-icon">ğŸ“Š</span>
                            <span>Redis ç›‘æ§</span>
                        </a>
                        <a href="/web/whitelist" class="nav-item" data-page="whitelist">
                            <span class="nav-item-icon">ğŸ›¡ï¸</span>
                            <span>ç™½åå•ç®¡ç†</span>
                        </a>
                        <a href="javascript:void(0)" onclick="openSettingsTab('password')" class="nav-item">
                            <span class="nav-item-icon">ğŸ”</span>
                            <span>ä¿®æ”¹å¯†ç </span>
                        </a>
                        <a href="javascript:void(0)" onclick="openSettingsTab('telegram')" class="nav-item">
                            <span class="nav-item-icon">ğŸ“±</span>
                            <span>Telegram å‘Šè­¦</span>
                        </a>
                        <a href="/web/admin" class="nav-item" data-page="admin">
                            <span class="nav-item-icon">ğŸ—„ï¸</span>
                            <span>æ•°æ®åº“ç®¡ç†</span>
                        </a>
                    </div>
                </nav>

                <div class="sidebar-footer">
                    <div class="sidebar-user">
                        <div class="sidebar-avatar" id="sidebar-avatar">A</div>
                        <div class="sidebar-user-info">
                            <div class="sidebar-user-name" id="sidebar-username">ç®¡ç†å‘˜</div>
                            <div class="sidebar-user-role" id="sidebar-role">å·²ç™»å½•</div>
                        </div>
                    </div>
                    <button onclick="toggleTheme()" class="theme-toggle" style="margin-top: 0.75rem; width: 100%;">
                        <span class="theme-toggle-icon">ğŸŒ™</span>
                        <span class="theme-toggle-track"></span>
                    </button>
                    <button onclick="logout()" class="nav-item"
                        style="margin-top: 0.5rem; width: 100%; justify-content: center; color: #f87171; border: 1px solid rgba(248, 113, 113, 0.3); background: rgba(248, 113, 113, 0.1);">
                        <span class="nav-item-icon">ğŸšª</span>
                        <span>é€€å‡ºç™»å½•</span>
                    </button>
                </div>
            </aside>

            <!-- Sidebar Overlay for Mobile -->
            <div class="sidebar-overlay hidden" id="sidebar-overlay" onclick="closeSidebar()"></div>

            <!-- Mobile Menu Button -->
            <button class="mobile-menu-btn hidden" id="mobile-menu-btn" onclick="toggleSidebar()">â˜°</button>

            <main class="main-content">
                <div class="max-w-7xl mx-auto p-6">
                    <!-- Header -->
                    <div class="flex items-center justify-between mb-8">
                        <div class="flex items-center gap-4">
                            <h1 class="text-3xl font-bold text-white flex items-center gap-3">
                                <span class="text-4xl">ğŸ“Š</span>
                                Redis ç¼“å­˜ç›‘æ§
                            </h1>
                        </div>
                        <button id="refresh-btn"
                            class="px-4 py-2 bg-blue-600 hover:bg-blue-500 rounded-lg text-white font-medium transition-colors flex items-center gap-2">
                            <svg id="refresh-icon" class="w-5 h-5" fill="none" stroke="currentColor"
                                viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">
                                </path>
                            </svg>
                            åˆ·æ–°æ•°æ®
                        </button>
                    </div>

                    <!-- Loading State -->
                    <div id="loading-state" class="glass-card rounded-2xl p-8 text-center">
                        <div
                            class="inline-block w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mb-4">
                        </div>
                        <p class="text-slate-300">åŠ è½½ Redis ç»Ÿè®¡æ•°æ®...</p>
                    </div>

                    <!-- Error State -->
                    <div id="error-state" class="hidden glass-card rounded-2xl p-8 border-red-500/30">
                        <div class="flex items-center gap-3 text-red-400 mb-2">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <span class="font-semibold">è¿æ¥å¤±è´¥</span>
                        </div>
                        <p id="error-message" class="text-slate-400"></p>
                    </div>

                    <!-- Main Content -->
                    <div id="main-content" class="hidden space-y-6">
                        <!-- Status Overview Cards -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            <!-- Connection Status -->
                            <div class="glass-card rounded-xl p-6 stat-card">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-slate-400 text-sm">è¿æ¥çŠ¶æ€</span>
                                    <span id="status-badge" class="px-3 py-1 rounded-full text-xs font-semibold"></span>
                                </div>
                                <div id="status-text" class="text-2xl font-bold text-white"></div>
                            </div>

                            <!-- Hit Rate -->
                            <div class="glass-card rounded-xl p-6 stat-card">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-slate-400 text-sm">ç¼“å­˜å‘½ä¸­ç‡</span>
                                    <span id="hit-rate-trend" class="text-xl"></span>
                                </div>
                                <div id="hit-rate" class="text-2xl font-bold text-emerald-400"></div>
                                <div class="text-xs text-slate-500 mt-1">
                                    <span id="hit-count">0</span> å‘½ä¸­ / <span id="miss-count">0</span> æœªå‘½ä¸­
                                </div>
                            </div>

                            <!-- Memory Usage -->
                            <div class="glass-card rounded-xl p-6 stat-card">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-slate-400 text-sm">å†…å­˜ä½¿ç”¨</span>
                                    <span id="memory-percent" class="text-xs font-semibold"></span>
                                </div>
                                <div id="memory-used" class="text-2xl font-bold text-blue-400"></div>
                                <div class="w-full bg-slate-700 rounded-full h-2 mt-3">
                                    <div id="memory-bar"
                                        class="progress-bar bg-gradient-to-r from-blue-500 to-cyan-500 h-2 rounded-full"
                                        style="width: 0%"></div>
                                </div>
                            </div>

                            <!-- Total Keys -->
                            <div class="glass-card rounded-xl p-6 stat-card">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-slate-400 text-sm">ç¼“å­˜é”®æ€»æ•°</span>
                                    <svg class="w-5 h-5 text-slate-400" fill="none" stroke="currentColor"
                                        viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path>
                                    </svg>
                                </div>
                                <div id="total-keys" class="text-2xl font-bold text-purple-400"></div>
                                <div class="text-xs text-slate-500 mt-1">
                                    <span id="evicted-keys">0</span> å·²æ·˜æ±° Â· <span id="expired-keys">0</span> å·²è¿‡æœŸ
                                </div>
                            </div>
                        </div>

                        <!-- Detailed Statistics -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Performance Metrics -->
                            <div class="glass-card rounded-2xl p-6">
                                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                                    <span>âš¡</span>
                                    æ€§èƒ½æŒ‡æ ‡
                                </h2>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center py-2 border-b border-slate-700">
                                        <span class="text-slate-300">æ€»è¿æ¥æ•°</span>
                                        <span id="total-connections" class="text-white font-semibold"></span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-slate-700">
                                        <span class="text-slate-300">æ´»è·ƒå®¢æˆ·ç«¯</span>
                                        <span id="connected-clients" class="text-white font-semibold"></span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-slate-700">
                                        <span class="text-slate-300">å¤„ç†çš„å‘½ä»¤æ•°</span>
                                        <span id="total-commands" class="text-white font-semibold"></span>
                                    </div>
                                    <div class="flex justify-between items-center py-2">
                                        <span class="text-slate-300">å†…å­˜å³°å€¼</span>
                                        <span id="memory-peak" class="text-white font-semibold"></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Cache Management -->
                            <div class="glass-card rounded-2xl p-6">
                                <h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
                                    <span>ğŸ› ï¸</span>
                                    ç¼“å­˜ç®¡ç†
                                </h2>
                                <div class="space-y-3">
                                    <button id="clear-nodes-btn"
                                        class="w-full px-4 py-3 bg-amber-600 hover:bg-amber-500 rounded-lg text-white font-medium transition-colors flex items-center justify-center gap-2">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                            </path>
                                        </svg>
                                        æ¸…é™¤èŠ‚ç‚¹ç¼“å­˜ (nodes:*)
                                    </button>

                                    <button id="clear-all-btn"
                                        class="w-full px-4 py-3 bg-red-600 hover:bg-red-500 rounded-lg text-white font-medium transition-colors flex items-center justify-center gap-2">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z">
                                            </path>
                                        </svg>
                                        æ¸…é™¤æ‰€æœ‰ç¼“å­˜
                                    </button>

                                    <button id="warmup-btn"
                                        class="w-full px-4 py-3 bg-emerald-600 hover:bg-emerald-500 rounded-lg text-white font-medium transition-colors flex items-center justify-center gap-2">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                        </svg>
                                        ç¼“å­˜é¢„çƒ­
                                    </button>
                                </div>

                                <!-- Auto-refresh Toggle -->
                                <div class="mt-6 pt-4 border-t border-slate-700">
                                    <label class="flex items-center justify-between cursor-pointer">
                                        <span class="text-slate-300">è‡ªåŠ¨åˆ·æ–° (30ç§’)</span>
                                        <div class="relative">
                                            <input type="checkbox" id="auto-refresh-toggle" class="sr-only peer">
                                            <div
                                                class="w-11 h-6 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600">
                                            </div>
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Last Updated -->
                        <div class="text-center text-slate-500 text-sm">
                            æœ€åæ›´æ–°: <span id="last-updated"></span>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="/static/js/sidebar.js"></script>
    <script type="module" src="/static/js/redis.js"></script>
</body>

</html>